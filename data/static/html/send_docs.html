<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <style>
      .warning {
        margin-bottom: 10px;
        padding: 10px;
        background-color: #ffc10733;
        border: 1px solid #ffc107;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    {% extends "base_with_status.html" %} {% block title %} Загрузка документов
    {% endblock %} {% block base_with_status_content %}

    <div class="container">
      <h1 class="mt-4">Загрузка документов</h1>
      <hr />

      <form
        id="fileUploadForm"
        action="/application/fill_docs"
        method="post"
        enctype="multipart/form-data"
      >
        <div class="mb-3">
          <label for="applicationFiles" class="form-label"
            >Заявление на зачисление:</label
          >
          <a href="/get_filled_application"
            >Скачать частично заполненное для вас заявление</a
          >
          <input
            type="file"
            class="form-control"
            id="applicationFiles"
            name="application_files"
            accept=".pdf, .jpg, .jpeg, .png"
            multiple
            required
          />
          <div id="applicationFilesThumbnail" class="thumbnail"></div>
        </div>

        <div class="mb-3">
          <label for="consentFiles" class="form-label"
            >Согласие на обработку данных:</label
          >

          <a href="/get_filled_consent"
            >Скачать частично заполненное для вас согласие</a
          >
          <input
            type="file"
            class="form-control"
            id="consentFiles"
            name="consent_files"
            accept=".pdf, .jpg, .jpeg, .png"
            multiple
            required
          />
          <div id="consentFilesThumbnail" class="thumbnail"></div>
        </div>

        <hr />

        <div class="mb-3">
          <label for="parentPassportFiles" class="form-label"
            >Паспорт родителя:</label
          >
          <input
            type="file"
            class="form-control"
            id="parentPassportFiles"
            name="parent_passport_files"
            accept=".pdf, .jpg, .jpeg, .png"
            multiple
            required
          />
          <div id="parentPassportFilesThumbnail" class="thumbnail"></div>
        </div>

        <div class="mb-3">
          <label for="childPassportFiles" class="form-label"
            >Паспорт ребенка:</label
          >
          <input
            type="file"
            class="form-control"
            id="childPassportFiles"
            name="child_passport_files"
            accept=".pdf, .jpg, .jpeg, .png"
            multiple
            required
          />
          <div id="childPassportFilesThumbnail" class="thumbnail"></div>
        </div>

        <hr />

        <div class="mb-3">
          <label for="parentSnilsFiles" class="form-label"
            >СНИЛС родителя:</label
          >
          <input
            type="file"
            class="form-control"
            id="parentSnilsFiles"
            name="parent_snils_files"
            accept=".pdf, .jpg, .jpeg, .png"
            multiple
            required
          />
          <div id="parentSnilsFilesThumbnail" class="thumbnail"></div>
        </div>

        <div class="mb-3">
          <label for="childSnilsFiles" class="form-label">СНИЛС ребенка:</label>
          <input
            type="file"
            class="form-control"
            id="childSnilsFiles"
            name="child_snils_files"
            accept=".pdf, .jpg, .jpeg, .png"
            multiple
            required
          />
          <div id="childSnilsFilesThumbnail" class="thumbnail"></div>
        </div>

        <div class="warning">
          Пожалуйста, обратите внимание, что документы могут быть отправлены
          только один раз. После отправки мы будем их рассматривать и уведомим
          вас о том, что документы были приняты или о проблемах с ними.
        </div>

        <button type="submit" class="btn btn-primary">Загрузить</button>
      </form>
    </div>
    <script>
      const displayThumbnail = (inputId, thumbnailId) => {
        const fileInput = document.getElementById(inputId);
        const thumbnail = document.getElementById(thumbnailId);
        fileInput.addEventListener("change", function () {
          thumbnail.innerHTML = "";

          for (let i = 0; i < fileInput.files.length; i++) {
            const file = fileInput.files[i];
            const reader = new FileReader();
            reader.onload = function (e) {
              const img = document.createElement("img");
              img.src = e.target.result;
              img.style.maxHeight = "150px";
              img.style.maxWidth = "100%";
              thumbnail.appendChild(img);
            };
            reader.readAsDataURL(file);
          }
        });
      };

      displayThumbnail("applicationFiles", "applicationFilesThumbnail");
      displayThumbnail("consentFiles", "consentFilesThumbnail");
      displayThumbnail("parentPassportFiles", "parentPassportFilesThumbnail");
      displayThumbnail("childPassportFiles", "childPassportFilesThumbnail");
      displayThumbnail("parentSnilsFiles", "parentSnilsFilesThumbnail");
      displayThumbnail("childSnilsFiles", "childSnilsFilesThumbnail");
    </script>
    {% endblock %}
  </body>
</html>
